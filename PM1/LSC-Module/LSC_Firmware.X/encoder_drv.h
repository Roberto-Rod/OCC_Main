/* ************************************************************************** */
/** @file encoder_drv.h
 *
 *  @brief Encoder driver header file.
 *
 *  @copyright Occuity Limited (c) 2021
 */
/* ************************************************************************** */
/* ************************************************************************** */


#ifndef ENCODER_DRV_H
#define	ENCODER_DRV_H
/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Included Files                                                    */
/* ************************************************************************** */
/* ************************************************************************** */
#include <xc.h>
#include <stdbool.h>

#include "main.h"
#ifdef	__cplusplus
extern "C" {
#endif

/* ************************************************************************** */
/* ************************************************************************** */
/* Section: Constants                                                         */
/* ************************************************************************** */
/* ************************************************************************** */

    
// *****************************************************************************
// *****************************************************************************
// Section: Data Types
// *****************************************************************************
// *****************************************************************************
    
    typedef struct{
        
        int32_t positions[2][LRS_POLE_BUF_NUM]; 
        int16_t dir_cnt[2];
        
    }z_poles_t;
    
// *****************************************************************************
// *****************************************************************************
// Section: Interface Functions
// *****************************************************************************
// *****************************************************************************
void __attribute__((interrupt, no_auto_psv)) _QEI1Interrupt(void);    
void encoder_interrupt (void);

void z_INT_callback(void); 
void enable_z_INT(void); 
void disable_z_INT(void);

bool get_z_positions(z_poles_t* cpy);

bool enc_move_wdt_check_clear(void);
void enc_move_wdt_start(void);
void enc_move_wdt_stop(void);
    
    
    
    
/* Provide C++ Compatibility */
#ifdef	__cplusplus
}
#endif

#endif	/* ENCODER_DRV_H */

